// Admin Panel JavaScript - Version Debug pour diagnostiquer les probl√®mes

console.log('üîç D√©marrage du mode debug admin...');

// Variables globales
let currentUser = null;
let products = [];
let orders = [];

// √âl√©ments DOM
const loginScreen = document.getElementById('loginScreen');
const adminDashboard = document.getElementById('adminDashboard');
const loginForm = document.getElementById('loginForm');
const loginError = document.getElementById('loginError');

// Fonction de diagnostic Firebase
function diagnoseFirebase() {
    console.log('üîç Diagnostic Firebase...');
    
    // V√©rifier si Firebase est charg√©
    console.log('Firebase disponible:', typeof firebase !== 'undefined');
    
    if (typeof firebase !== 'undefined') {
        console.log('Firebase app:', !!firebase.app);
        console.log('Firebase auth:', !!firebase.auth);
        console.log('Firebase firestore:', !!firebase.firestore);
        
        try {
            const auth = firebase.auth();
            console.log('Auth instance:', !!auth);
            console.log('Auth currentUser:', auth.currentUser);
        } catch (error) {
            console.error('Erreur auth:', error);
        }
        
        try {
            const db = firebase.firestore();
            console.log('Firestore instance:', !!db);
        } catch (error) {
            console.error('Erreur firestore:', error);
        }
    }
}

// Initialisation avec diagnostic
document.addEventListener('DOMContentLoaded', function() {
    console.log('üöÄ Initialisation du panneau admin (mode debug)...');
    
    // Diagnostic imm√©diat
    diagnoseFirebase();
    
    // Attendre un peu puis r√©essayer
    setTimeout(() => {
        console.log('üîç Second diagnostic apr√®s 2 secondes...');
        diagnoseFirebase();
        initializeAdmin();
    }, 2000);
});

function initializeAdmin() {
    console.log('üîß Initialisation admin...');
    
    // V√©rifier si Firebase est charg√©
    if (typeof firebase === 'undefined') {
        console.error('‚ùå Firebase non disponible');
        showError('Firebase n\'est pas charg√©. Veuillez actualiser la page.');
        return;
    }

    console.log('‚úÖ Firebase d√©tect√©');

    try {
        // Test de connexion Firebase
        console.log('üß™ Test de connexion Firebase...');
        
        // √âcouter les changements d'authentification avec gestion d'erreur
        firebase.auth().onAuthStateChanged((user) => {
            console.log('üîê √âtat d\'authentification:', user ? 'Connect√©' : 'D√©connect√©');
            if (user) {
                console.log('üë§ Utilisateur:', user.email);
                currentUser = user;
                showDashboard();
            } else {
                console.log('üë§ Aucun utilisateur connect√©');
                showLoginScreen();
            }
        }, (error) => {
            console.error('‚ùå Erreur d\'authentification:', error);
            showLoginError('Erreur de connexion Firebase: ' + error.message);
        });

        // Configurer les event listeners
        setupEventListeners();
        
        console.log('‚úÖ Initialisation termin√©e');
        
    } catch (error) {
        console.error('‚ùå Erreur d\'initialisation Firebase:', error);
        showError('Erreur d\'initialisation: ' + error.message);
    }
}

function setupEventListeners() {
    console.log('üéØ Configuration des event listeners...');
    
    // Formulaire de connexion
    if (loginForm) {
        loginForm.addEventListener('submit', handleLogin);
        console.log('‚úÖ Event listener login configur√©');
    } else {
        console.error('‚ùå Formulaire de login non trouv√©');
    }

    // Menu de navigation
    const menuItems = document.querySelectorAll('.menu-item');
    console.log('üìã Menu items trouv√©s:', menuItems.length);
    
    menuItems.forEach(item => {
        item.addEventListener('click', handleNavigation);
    });

    // D√©connexion
    const logoutBtn = document.querySelector('.logout-btn');
    if (logoutBtn) {
        logoutBtn.addEventListener('click', handleLogout);
        console.log('‚úÖ Event listener logout configur√©');
    }

    console.log('‚úÖ Event listeners configur√©s');
}

// Fonctions d'authentification avec debug
async function handleLogin(e) {
    e.preventDefault();
    console.log('üîë Tentative de connexion...');
    
    const email = document.getElementById('email').value;
    const password = document.getElementById('password').value;
    
    console.log('üìß Email saisi:', email);
    console.log('üîí Mot de passe saisi:', password ? 'Oui' : 'Non');
    
    if (!email || !password) {
        console.log('‚ùå Champs manquants');
        showLoginError('Veuillez remplir tous les champs');
        return;
    }
    
    // V√©rifier la connexion Firebase avant de tenter la connexion
    if (typeof firebase === 'undefined' || !firebase.auth) {
        console.error('‚ùå Firebase non initialis√©');
        showLoginError('Erreur: Firebase non initialis√©. Veuillez actualiser la page.');
        return;
    }
    
    try {
        console.log('‚è≥ D√©but de la connexion...');
        showLoading('Connexion en cours...');
        
        console.log('üî• Firebase Auth disponible:', !!firebase.auth());
        
        // Test de connectivit√© r√©seau
        console.log('üåê Test de connectivit√©...');
        
        // Ajouter un timeout pour √©viter les blocages
        const loginPromise = firebase.auth().signInWithEmailAndPassword(email, password);
        const timeoutPromise = new Promise((_, reject) => 
            setTimeout(() => reject(new Error('Timeout de connexion')), 15000)
        );
        
        console.log('üöÄ Envoi de la requ√™te de connexion...');
        const userCredential = await Promise.race([loginPromise, timeoutPromise]);
        
        console.log('‚úÖ Connexion r√©ussie:', userCredential.user.email);
        console.log('üë§ UID:', userCredential.user.uid);
        
        hideLoading();
        
    } catch (error) {
        console.error('‚ùå Erreur de connexion compl√®te:', error);
        console.error('‚ùå Code d\'erreur:', error.code);
        console.error('‚ùå Message d\'erreur:', error.message);
        
        hideLoading();
        
        // Messages d'erreur plus sp√©cifiques
        let errorMessage = '';
        
        if (error.message === 'Timeout de connexion') {
            errorMessage = 'Timeout de connexion. V√©rifiez votre connexion internet et r√©essayez.';
        } else if (error.code === 'auth/network-request-failed') {
            errorMessage = 'Erreur r√©seau. V√©rifiez votre connexion internet.';
        } else if (error.code === 'auth/too-many-requests') {
            errorMessage = 'Trop de tentatives. Attendez quelques minutes avant de r√©essayer.';
        } else if (error.code === 'auth/user-not-found') {
            errorMessage = 'Utilisateur non trouv√©. V√©rifiez votre email.';
        } else if (error.code === 'auth/wrong-password') {
            errorMessage = 'Mot de passe incorrect.';
        } else if (error.code === 'auth/invalid-email') {
            errorMessage = 'Format d\'email invalide.';
        } else if (error.code === 'auth/user-disabled') {
            errorMessage = 'Compte d√©sactiv√©.';
        } else if (error.code === 'auth/invalid-credential') {
            errorMessage = 'Identifiants invalides.';
        } else {
            errorMessage = 'Erreur de connexion: ' + error.message;
        }
        
        console.log('üìù Message d\'erreur affich√©:', errorMessage);
        showLoginError(errorMessage);
    }
}

async function handleLogout() {
    console.log('üëã Tentative de d√©connexion...');
    try {
        await firebase.auth().signOut();
        console.log('‚úÖ D√©connexion r√©ussie');
    } catch (error) {
        console.error('‚ùå Erreur de d√©connexion:', error);
        showError('Erreur lors de la d√©connexion: ' + error.message);
    }
}

// Fonctions d'affichage avec debug
function showLoginScreen() {
    console.log('üì± Affichage √©cran de connexion');
    if (loginScreen) {
        loginScreen.style.display = 'flex';
        console.log('‚úÖ √âcran de connexion affich√©');
    } else {
        console.error('‚ùå √âl√©ment loginScreen non trouv√©');
    }
    
    if (adminDashboard) {
        adminDashboard.style.display = 'none';
        console.log('‚úÖ Dashboard masqu√©');
    }
    
    // R√©initialiser le formulaire
    const emailInput = document.getElementById('email');
    const passwordInput = document.getElementById('password');
    if (emailInput) emailInput.value = '';
    if (passwordInput) passwordInput.value = '';
    
    // NE PAS afficher d'erreur au chargement initial
    if (loginError) {
        loginError.textContent = '';
        loginError.style.display = 'none';
    }
}

function showDashboard() {
    console.log('üìä Affichage dashboard');
    if (loginScreen) {
        loginScreen.style.display = 'none';
        console.log('‚úÖ √âcran de connexion masqu√©');
    }
    
    if (adminDashboard) {
        adminDashboard.style.display = 'flex';
        console.log('‚úÖ Dashboard affich√©');
    } else {
        console.error('‚ùå √âl√©ment adminDashboard non trouv√©');
    }
    
    // Afficher l'email de l'admin
    const adminEmailElement = document.getElementById('adminEmail');
    if (adminEmailElement && currentUser) {
        adminEmailElement.textContent = currentUser.email;
        console.log('‚úÖ Email admin affich√©:', currentUser.email);
    }
    
    // IMPORTANT: Charger les donn√©es du dashboard
    loadDashboardData();
}

function showLoginError(message) {
    console.log('‚ö†Ô∏è Erreur de connexion:', message);
    if (loginError) {
        loginError.textContent = message;
        loginError.style.display = 'block';
        console.log('‚úÖ Message d\'erreur affich√©');
    } else {
        console.error('‚ùå √âl√©ment loginError non trouv√©');
    }
}

// ===== FONCTIONS POUR CHARGER LES DONN√âES FIREBASE =====

// Fonction pour charger les donn√©es du dashboard
async function loadDashboardData() {
    console.log('üìä Chargement des donn√©es du dashboard...');
    
    try {
        // Charger le nombre de produits
        console.log('üì¶ Chargement des produits...');
        const productsSnapshot = await firebase.firestore().collection('products').get();
        const totalProductsElement = document.getElementById('totalProducts');
        if (totalProductsElement) {
            totalProductsElement.textContent = productsSnapshot.size;
            console.log('‚úÖ Produits charg√©s:', productsSnapshot.size);
        }

        // Charger le nombre de commandes
        console.log('üõí Chargement des commandes...');
        const ordersSnapshot = await firebase.firestore().collection('orders').get();
        const totalOrdersElement = document.getElementById('totalOrders');
        if (totalOrdersElement) {
            totalOrdersElement.textContent = ordersSnapshot.size;
            console.log('‚úÖ Commandes charg√©es:', ordersSnapshot.size);
        }

        // Charger les commandes en attente
        console.log('‚è≥ Chargement des commandes en attente...');
        const pendingOrdersSnapshot = await firebase.firestore()
            .collection('orders')
            .where('status', '==', 'pending')
            .get();
        const pendingOrdersElement = document.getElementById('pendingOrders');
        if (pendingOrdersElement) {
            pendingOrdersElement.textContent = pendingOrdersSnapshot.size;
            console.log('‚úÖ Commandes en attente:', pendingOrdersSnapshot.size);
        }

        // Calculer le chiffre d'affaires total
        console.log('üí∞ Calcul du chiffre d\'affaires...');
        let totalRevenue = 0;
        ordersSnapshot.forEach(doc => {
            const order = doc.data();
            if (order.status === 'completed' && order.total) {
                const totalValue = typeof order.total === 'number' 
                    ? order.total 
                    : parseFloat(order.total.toString().replace(/[^\d]/g, ''));
                totalRevenue += totalValue || 0;
            }
        });
        
        const totalRevenueElement = document.getElementById('totalRevenue');
        if (totalRevenueElement) {
            totalRevenueElement.textContent = totalRevenue.toLocaleString() + ' DA';
            console.log('‚úÖ Chiffre d\'affaires calcul√©:', totalRevenue);
        }

        // Charger les commandes r√©centes
        await loadRecentOrders();

        console.log('‚úÖ Donn√©es du dashboard charg√©es avec succ√®s');

    } catch (error) {
        console.error('‚ùå Erreur lors du chargement du dashboard:', error);
        showError('Erreur lors du chargement des donn√©es: ' + error.message);
    }
}

// Fonction pour charger les commandes r√©centes
async function loadRecentOrders() {
    console.log('üìã Chargement des commandes r√©centes...');
    
    try {
        const recentOrdersSnapshot = await firebase.firestore()
            .collection('orders')
            .orderBy('createdAt', 'desc')
            .limit(5)
            .get();

        const recentOrdersList = document.getElementById('recentOrdersList');
        if (!recentOrdersList) {
            console.error('‚ùå √âl√©ment recentOrdersList non trouv√©');
            return;
        }

        recentOrdersList.innerHTML = '';

        if (recentOrdersSnapshot.empty) {
            recentOrdersList.innerHTML = '<p style="text-align: center; color: #666; padding: 20px;">Aucune commande r√©cente</p>';
            console.log('‚ÑπÔ∏è Aucune commande r√©cente trouv√©e');
            return;
        }

        console.log('üìù Nombre de commandes r√©centes:', recentOrdersSnapshot.size);
        recentOrdersSnapshot.forEach(doc => {
            const order = doc.data();
            console.log('üìÑ Commande r√©cente:', doc.id, order);
            const orderElement = createRecentOrderElement(order, doc.id);
            recentOrdersList.appendChild(orderElement);
        });

        console.log('‚úÖ Commandes r√©centes charg√©es');

    } catch (error) {
        console.error('‚ùå Erreur lors du chargement des commandes r√©centes:', error);
        const recentOrdersList = document.getElementById('recentOrdersList');
        if (recentOrdersList) {
            recentOrdersList.innerHTML = '<p style="text-align: center; color: #dc3545; padding: 20px;">Erreur lors du chargement des commandes r√©centes</p>';
        }
    }
}

// Fonction pour cr√©er un √©l√©ment de commande r√©cente
function createRecentOrderElement(order, orderId) {
    const div = document.createElement('div');
    div.className = 'order-item';
    
    const date = order.createdAt ? order.createdAt.toDate().toLocaleDateString('fr-FR', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    }) : 'N/A';
    
    const statusClass = order.status || 'pending';
    const statusText = getStatusText(order.status);
    
    div.innerHTML = `
        <div class="order-info">
            <h4>#${order.orderNumber || orderId.substring(0, 8)}</h4>
            <p><i class="fas fa-user"></i> ${order.customerName || 'N/A'}</p>
            <p><i class="fas fa-phone"></i> ${order.customerPhone || 'N/A'}</p>
            <p><i class="fas fa-map-marker-alt"></i> ${order.wilaya || 'N/A'}</p>
            <p><i class="fas fa-clock"></i> ${date}</p>
        </div>
        <div class="order-summary">
            <div class="order-total">${order.total || '0'} DA</div>
            <div class="order-status">
                <span class="status-badge status-${statusClass}">${statusText}</span>
            </div>
            <button class="btn btn-sm btn-info" onclick="viewOrder('${orderId}')">
                <i class="fas fa-eye"></i> Voir
            </button>
        </div>
    `;
    
    return div;
}

// Fonction pour charger toutes les commandes
async function loadOrders() {
    console.log('üõí Chargement de toutes les commandes...');
    
    try {
        const ordersSnapshot = await firebase.firestore()
            .collection('orders')
            .orderBy('createdAt', 'desc')
            .get();

        orders = [];
        ordersSnapshot.forEach(doc => {
            orders.push({ id: doc.id, ...doc.data() });
        });

        console.log('üìä Nombre total de commandes:', orders.length);
        displayOrders();

    } catch (error) {
        console.error('‚ùå Erreur lors du chargement des commandes:', error);
        showError('Erreur lors du chargement des commandes: ' + error.message);
    }
}

// Fonction pour afficher les commandes
function displayOrders() {
    console.log('üìã Affichage des commandes...');
    const tbody = document.getElementById('ordersTableBody');
    if (!tbody) {
        console.error('‚ùå √âl√©ment ordersTableBody non trouv√©');
        return;
    }

    tbody.innerHTML = '';

    if (orders.length === 0) {
        tbody.innerHTML = '<tr><td colspan="8" style="text-align: center;">Aucune commande trouv√©e</td></tr>';
        console.log('‚ÑπÔ∏è Aucune commande √† afficher');
        return;
    }

    console.log('üìù Affichage de', orders.length, 'commandes');
    orders.forEach((order, index) => {
        console.log(`üìÑ Commande ${index + 1}:`, order);
        const row = createOrderRow(order);
        tbody.appendChild(row);
    });
}

// Fonction pour cr√©er une ligne de commande
function createOrderRow(order) {
    const tr = document.createElement('tr');
    
    const date = order.createdAt ? order.createdAt.toDate().toLocaleDateString('fr-FR', {
        day: '2-digit',
        month: '2-digit',
        year: 'numeric',
        hour: '2-digit',
        minute: '2-digit'
    }) : 'N/A';
    
    const statusClass = order.status || 'pending';
    const statusText = getStatusText(order.status);
    
    // Calculer le nombre d'articles
    const totalItems = order.items ? order.items.reduce((sum, item) => sum + (item.quantity || 1), 0) : 0;
    
    // Ordre des colonnes: Checkbox, ID, Client, Wilaya, Total, Statut, Date, Actions
    tr.innerHTML = `
        <td><input type="checkbox" class="order-checkbox" data-order-id="${order.id}"></td>
        <td><strong>#${order.orderNumber || order.id.substring(0, 8)}</strong></td>
        <td>
            <div class="customer-info">
                <div><i class="fas fa-user"></i> ${order.customerName || 'N/A'}</div>
                <div><i class="fas fa-phone"></i> ${order.customerPhone || 'N/A'}</div>
            </div>
        </td>
        <td><i class="fas fa-map-marker-alt"></i> ${order.wilaya || 'N/A'}</td>
        <td>
            <div class="order-details">
                <div class="total-amount"><strong>${order.total || '0'} DA</strong></div>
                <small>${totalItems} article(s)</small>
            </div>
        </td>
        <td><span class="status-badge status-${statusClass}">${statusText}</span></td>
        <td>
            <div class="date-info">
                <div>${date.split(' ')[0]}</div>
                <small>${date.split(' ')[1] || ''}</small>
            </div>
        </td>
        <td>
            <div class="action-buttons">
                <button class="btn btn-sm btn-info" onclick="viewOrder('${order.id}')" title="Voir d√©tails">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-sm btn-warning" onclick="editOrderStatus('${order.id}')" title="Modifier statut">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-sm btn-danger" onclick="deleteOrder('${order.id}')" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </td>
    `;
    
    return tr;
}

// Fonctions utilitaires
function getStatusText(status) {
    const statuses = {
        pending: 'En attente',
        processing: 'En cours',
        completed: 'Termin√©e',
        cancelled: 'Annul√©e'
    };
    return statuses[status] || status;
}

// ===== FONCTIONS POUR LA GESTION DES PRODUITS =====

// Fonction pour afficher le modal d'ajout de produit
window.showAddProductModal = function() {
    console.log('‚ûï Ouverture du modal d\'ajout de produit');
    const modal = document.getElementById('productModal');
    const title = document.getElementById('productModalTitle');
    
    if (modal && title) {
        title.textContent = 'Ajouter un produit';
        modal.style.display = 'block';
        
        // R√©initialiser le formulaire
        const form = document.getElementById('productForm');
        if (form) form.reset();
        
        // Masquer le calcul de rentabilit√©
        const profitCalculation = document.getElementById('profitCalculation');
        if (profitCalculation) {
            profitCalculation.style.display = 'none';
        }
        
        // Configurer les event listeners pour le calcul automatique
        setupProfitCalculation();
        
        // Configurer l'upload d'image
        setupImageUpload();
        
        // Configurer le formulaire de produit
        const productForm = document.getElementById('productForm');
        if (productForm) {
            productForm.onsubmit = saveProduct;
            productForm.removeAttribute('data-product-id'); // Reset pour nouvel ajout
        }
        
        // Fermer le modal
        const closeBtn = modal.querySelector('.close-modal');
        if (closeBtn) {
            closeBtn.onclick = () => modal.style.display = 'none';
        }
        
        // Fermer en cliquant √† l'ext√©rieur
        modal.onclick = (e) => {
            if (e.target === modal) {
                modal.style.display = 'none';
            }
        };
    }
};

// Fonction pour fermer le modal de produit
window.closeProductModal = function() {
    const modal = document.getElementById('productModal');
    if (modal) modal.style.display = 'none';
};

// Fonction pour configurer le calcul automatique de rentabilit√©
function setupProfitCalculation() {
    console.log('üßÆ Configuration du calcul de rentabilit√©...');
    
    const purchasePriceInput = document.getElementById('productPurchasePrice');
    const salePriceInput = document.getElementById('productPrice');
    
    if (purchasePriceInput && salePriceInput) {
        // Event listeners pour calculer en temps r√©el
        purchasePriceInput.addEventListener('input', calculateProfit);
        salePriceInput.addEventListener('input', calculateProfit);
        
        console.log('‚úÖ Event listeners pour calcul de rentabilit√© configur√©s');
    }
}

// Fonction pour calculer la rentabilit√©
function calculateProfit() {
    console.log('üßÆ Calcul de la rentabilit√©...');
    
    const purchasePrice = parseFloat(document.getElementById('productPurchasePrice').value) || 0;
    const salePrice = parseFloat(document.getElementById('productPrice').value) || 0;
    
    console.log('üí∞ Prix d\'achat:', purchasePrice, 'DA');
    console.log('üí∞ Prix de vente:', salePrice, 'DA');
    
    const profitCalculation = document.getElementById('profitCalculation');
    const profitMargin = document.getElementById('profitMargin');
    const profitPercentage = document.getElementById('profitPercentage');
    const profitStatus = document.getElementById('profitStatus');
    
    if (!profitCalculation || !profitMargin || !profitPercentage || !profitStatus) {
        console.error('‚ùå √âl√©ments de calcul de rentabilit√© non trouv√©s');
        return;
    }
    
    // Si les deux prix sont saisis
    if (purchasePrice > 0 && salePrice > 0) {
        // Afficher la section de calcul
        profitCalculation.style.display = 'block';
        profitCalculation.classList.add('show');
        
        // Calculer la marge b√©n√©ficiaire
        const margin = salePrice - purchasePrice;
        const marginPercentage = (margin / purchasePrice * 100).toFixed(1);
        
        console.log('üìä Marge:', margin, 'DA');
        console.log('üìä Pourcentage:', marginPercentage, '%');
        
        // Mettre √† jour l'affichage
        profitMargin.textContent = margin.toLocaleString() + ' DA';
        profitPercentage.textContent = marginPercentage + '%';
        
        // D√©terminer le statut de rentabilit√©
        let status = '';
        let statusClass = '';
        
        if (margin < 0) {
            status = 'PERTE';
            statusClass = 'loss';
            profitPercentage.className = 'profit-percentage low';
        } else if (marginPercentage < 15) {
            status = 'FAIBLE';
            statusClass = 'low';
            profitPercentage.className = 'profit-percentage low';
        } else if (marginPercentage < 30) {
            status = 'CORRECTE';
            statusClass = 'good';
            profitPercentage.className = 'profit-percentage medium';
        } else {
            status = 'EXCELLENTE';
            statusClass = 'excellent';
            profitPercentage.className = 'profit-percentage high';
        }
        
        profitStatus.textContent = status;
        profitStatus.className = 'profit-status ' + statusClass;
        
        console.log('‚úÖ Rentabilit√© calcul√©e:', status);
        
    } else {
        // Masquer la section de calcul si les prix ne sont pas complets
        profitCalculation.style.display = 'none';
        console.log('‚ÑπÔ∏è Calcul masqu√© - prix incomplets');
    }
}

// Fonction pour g√©rer l'upload d'image
function setupImageUpload() {
    console.log('üñºÔ∏è Configuration de l\'upload d\'image...');
    
    const imageUploadArea = document.getElementById('imageUploadArea');
    const imageInput = document.getElementById('imageInput');
    const imagePreview = document.getElementById('imagePreview');
    
    if (!imageUploadArea || !imageInput || !imagePreview) {
        console.error('‚ùå √âl√©ments d\'upload d\'image non trouv√©s');
        return;
    }
    
    // Clic sur la zone d'upload
    imageUploadArea.addEventListener('click', () => {
        imageInput.click();
    });
    
    // Drag & Drop
    imageUploadArea.addEventListener('dragover', (e) => {
        e.preventDefault();
        imageUploadArea.classList.add('drag-over');
    });
    
    imageUploadArea.addEventListener('dragleave', () => {
        imageUploadArea.classList.remove('drag-over');
    });
    
    imageUploadArea.addEventListener('drop', (e) => {
        e.preventDefault();
        imageUploadArea.classList.remove('drag-over');
        
        const files = e.dataTransfer.files;
        if (files.length > 0) {
            handleImageFile(files[0]);
        }
    });
    
    // S√©lection de fichier
    imageInput.addEventListener('change', (e) => {
        if (e.target.files.length > 0) {
            handleImageFile(e.target.files[0]);
        }
    });
    
    console.log('‚úÖ Upload d\'image configur√©');
}

// Fonction pour traiter le fichier image
function handleImageFile(file) {
    console.log('üñºÔ∏è Traitement du fichier image:', file.name);
    
    // V√©rifier le type de fichier
    if (!file.type.startsWith('image/')) {
        alert('Veuillez s√©lectionner un fichier image valide');
        return;
    }
    
    // V√©rifier la taille (max 5MB)
    if (file.size > 5 * 1024 * 1024) {
        alert('Le fichier est trop volumineux. Taille maximum : 5MB');
        return;
    }
    
    // Cr√©er un aper√ßu
    const reader = new FileReader();
    reader.onload = (e) => {
        const imagePreview = document.getElementById('imagePreview');
        const imageInput = document.getElementById('productImage');
        
        if (imagePreview && imageInput) {
            imagePreview.innerHTML = `
                <img src="${e.target.result}" alt="Aper√ßu du produit" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                <p>Image s√©lectionn√©e: ${file.name}</p>
            `;
            
            // Stocker l'image en base64 pour la sauvegarde
            imageInput.value = e.target.result;
            console.log('‚úÖ Image pr√©par√©e pour la sauvegarde');
        }
    };
    
    reader.readAsDataURL(file);
}

// Fonction pour sauvegarder un produit
window.saveProduct = async function(e) {
    e.preventDefault();
    console.log('üíæ Sauvegarde du produit...');
    
    const nameAr = document.getElementById('productNameAr').value;
    const nameFr = document.getElementById('productNameFr').value;
    const purchasePrice = parseFloat(document.getElementById('productPurchasePrice').value) || 0;
    const salePrice = parseFloat(document.getElementById('productPrice').value) || 0;
    const stock = parseInt(document.getElementById('productStock').value) || 0;
    const category = document.getElementById('productCategory').value;
    const descriptionAr = document.getElementById('productDescriptionAr').value;
    const descriptionFr = document.getElementById('productDescriptionFr').value;
    const image = document.getElementById('productImage').value;
    
    if (!nameAr || !nameFr || !purchasePrice || !salePrice || !category) {
        alert('Veuillez remplir tous les champs obligatoires');
        return;
    }
    
    // V√©rifier si c'est une modification ou un ajout
    const form = document.getElementById('productForm');
    const productId = form ? form.getAttribute('data-product-id') : null;
    const isEdit = !!productId;
    
    const productData = {
        name: {
            ar: nameAr,
            fr: nameFr
        },
        purchasePrice: purchasePrice,
        price: salePrice, // Prix de vente pour compatibilit√© avec le site principal
        salePrice: salePrice,
        stock: stock,
        category: category,
        description: {
            ar: descriptionAr,
            fr: descriptionFr
        },
        image: image || '', // Image en base64 ou URL
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
    };
    
    // Ajouter createdAt seulement pour les nouveaux produits
    if (!isEdit) {
        productData.createdAt = firebase.firestore.FieldValue.serverTimestamp();
    }
    
    console.log('üì¶ Donn√©es du produit:', productData);
    console.log('üîÑ Mode:', isEdit ? 'Modification' : 'Ajout');
    
    try {
        let docRef;
        
        if (isEdit) {
            // Mise √† jour du produit existant
            await firebase.firestore().collection('products').doc(productId).update(productData);
            console.log('‚úÖ Produit mis √† jour avec ID:', productId);
            alert('Produit modifi√© avec succ√®s !');
        } else {
            // Ajout d'un nouveau produit
            docRef = await firebase.firestore().collection('products').add(productData);
            console.log('‚úÖ Produit sauvegard√© avec ID:', docRef.id);
            alert('Produit ajout√© avec succ√®s !');
        }
        
        closeProductModal();
        
        // Recharger les produits
        loadProducts();
        
    } catch (error) {
        console.error('‚ùå Erreur lors de la sauvegarde:', error);
        alert('Erreur lors de la sauvegarde: ' + error.message);
    }
};

// Fonction pour charger tous les produits
async function loadProducts() {
    console.log('üì¶ Chargement des produits...');
    
    try {
        const productsSnapshot = await firebase.firestore()
            .collection('products')
            .orderBy('createdAt', 'desc')
            .get();

        products = [];
        productsSnapshot.forEach(doc => {
            products.push({ id: doc.id, ...doc.data() });
        });

        console.log('üìä Nombre total de produits:', products.length);
        displayProducts();

    } catch (error) {
        console.error('‚ùå Erreur lors du chargement des produits:', error);
        showError('Erreur lors du chargement des produits: ' + error.message);
    }
}

// Fonction pour afficher les produits
function displayProducts() {
    console.log('üìã Affichage des produits...');
    const tbody = document.getElementById('productsTableBody');
    if (!tbody) {
        console.error('‚ùå √âl√©ment productsTableBody non trouv√©');
        return;
    }

    tbody.innerHTML = '';

    if (products.length === 0) {
        tbody.innerHTML = '<tr><td colspan="9" style="text-align: center;">Aucun produit trouv√©</td></tr>';
        console.log('‚ÑπÔ∏è Aucun produit √† afficher');
        return;
    }

    console.log('üìù Affichage de', products.length, 'produits');
    products.forEach((product, index) => {
        console.log(`üì¶ Produit ${index + 1}:`, product);
        const row = createProductRow(product);
        tbody.appendChild(row);
    });
}

// Fonction pour cr√©er une ligne de produit
function createProductRow(product) {
    const tr = document.createElement('tr');
    
    const nameAr = product.name?.ar || product.name || 'N/A';
    const nameFr = product.name?.fr || product.name || 'N/A';
    const purchasePrice = product.purchasePrice || 0;
    const salePrice = product.price || product.salePrice || 0;
    const stock = product.stock || 0;
    const category = product.category || 'N/A';
    
    // Calculer la marge
    const margin = purchasePrice > 0 ? ((salePrice - purchasePrice) / purchasePrice * 100).toFixed(1) : 0;
    const marginClass = margin > 30 ? 'high-margin' : margin > 15 ? 'medium-margin' : 'low-margin';
    
    // Image du produit
    const imageUrl = product.image || '../image/default-product.jpg';

    tr.innerHTML = `
        <td>
            <img src="${imageUrl}" alt="${nameFr}" class="product-image" onerror="this.src='../image/default-product.jpg'">
        </td>
        <td><strong>${nameAr}</strong></td>
        <td><strong>${nameFr}</strong></td>
        <td class="purchase-price">${purchasePrice.toLocaleString()} DA</td>
        <td class="sale-price">${salePrice.toLocaleString()} DA</td>
        <td class="margin ${marginClass}">
            <span class="margin-value">${margin}%</span>
            <small class="margin-amount">+${(salePrice - purchasePrice).toLocaleString()} DA</small>
        </td>
        <td class="stock-info">
            <span class="stock-count ${stock < 10 ? 'low-stock' : stock < 5 ? 'critical-stock' : ''}">${stock}</span>
            <small>unit√©s</small>
        </td>
        <td><span class="category-badge">${getCategoryText(category)}</span></td>
        <td>
            <div class="action-buttons">
                <button class="btn btn-sm btn-info" onclick="viewProduct('${product.id}')" title="Voir d√©tails">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-sm btn-warning" onclick="editProduct('${product.id}')" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-sm btn-success" onclick="updateStock('${product.id}')" title="G√©rer stock">
                    <i class="fas fa-boxes"></i>
                </button>
                <button class="btn btn-sm btn-danger" onclick="deleteProduct('${product.id}')" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </td>
    `;
    
    return tr;
}

// Fonction pour obtenir le texte de la cat√©gorie
function getCategoryText(category) {
    const categories = {
        hair: 'Cheveux',
        makeup: 'Maquillage',
        skincare: 'Soins',
        lenses: 'Lentilles',
        clothing: 'V√™tements'
    };
    return categories[category] || category;
}

// Fonction pour voir un produit
window.viewProduct = function(productId) {
    console.log('üëÅÔ∏è Voir produit:', productId);
    const product = products.find(p => p.id === productId);
    if (product) {
        console.log('üì¶ D√©tails du produit:', product);
        alert(`Produit: ${product.name?.fr || product.name || 'N/A'}\nPrix d'achat: ${product.purchasePrice || 0} DA\nPrix de vente: ${product.price || 0} DA\nStock: ${product.stock || 0} unit√©s`);
    }
};

// Fonction pour modifier un produit
window.editProduct = function(productId) {
    console.log('‚úèÔ∏è Modifier produit:', productId);
    const product = products.find(p => p.id === productId);
    if (product) {
        showAddProductModal();
        
        // Remplir le formulaire avec les donn√©es du produit
        const title = document.getElementById('productModalTitle');
        if (title) title.textContent = 'Modifier le produit';
        
        // Remplir tous les champs
        const nameAr = document.getElementById('productNameAr');
        const nameFr = document.getElementById('productNameFr');
        const purchasePrice = document.getElementById('productPurchasePrice');
        const salePrice = document.getElementById('productPrice');
        const stock = document.getElementById('productStock');
        const category = document.getElementById('productCategory');
        const descriptionAr = document.getElementById('productDescriptionAr');
        const descriptionFr = document.getElementById('productDescriptionFr');
        
        if (nameAr) nameAr.value = product.name?.ar || product.name || '';
        if (nameFr) nameFr.value = product.name?.fr || product.name || '';
        if (purchasePrice) purchasePrice.value = product.purchasePrice || 0;
        if (salePrice) salePrice.value = product.price || product.salePrice || 0;
        if (stock) stock.value = product.stock || 0;
        if (category) category.value = product.category || '';
        if (descriptionAr) descriptionAr.value = product.description?.ar || '';
        if (descriptionFr) descriptionFr.value = product.description?.fr || '';
        
        // Afficher l'image si elle existe
        if (product.image) {
            const imagePreview = document.getElementById('imagePreview');
            const imageInput = document.getElementById('productImage');
            if (imagePreview && imageInput) {
                imagePreview.innerHTML = `
                    <img src="${product.image}" alt="Image actuelle" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                    <p>Image actuelle</p>
                `;
                imageInput.value = product.image;
            }
        }
        
        // Stocker l'ID du produit pour la mise √† jour
        const form = document.getElementById('productForm');
        if (form) {
            form.setAttribute('data-product-id', productId);
        }
        
        // Calculer la rentabilit√©
        calculateProfit();
        
        console.log('‚úÖ Formulaire rempli pour modification');
    }
};

// Fonction pour mettre √† jour le stock
window.updateStock = async function(productId) {
    console.log('üì¶ G√©rer stock:', productId);
    const product = products.find(p => p.id === productId);
    if (product) {
        const currentStock = product.stock || 0;
        const newStock = prompt(`Stock actuel: ${currentStock} unit√©s\nNouveau stock pour "${product.name?.fr || product.name || 'ce produit'}":`, currentStock);
        
        if (newStock !== null && !isNaN(newStock) && parseInt(newStock) >= 0) {
            try {
                await firebase.firestore().collection('products').doc(productId).update({
                    stock: parseInt(newStock),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                console.log('‚úÖ Stock mis √† jour:', newStock);
                alert(`Stock mis √† jour: ${newStock} unit√©s`);
                
                // Recharger les produits pour afficher la mise √† jour
                loadProducts();
                
            } catch (error) {
                console.error('‚ùå Erreur lors de la mise √† jour du stock:', error);
                alert('Erreur lors de la mise √† jour du stock: ' + error.message);
            }
        }
    }
};

// Fonction pour supprimer un produit
window.deleteProduct = async function(productId) {
    console.log('üóëÔ∏è Supprimer produit:', productId);
    const product = products.find(p => p.id === productId);
    
    if (product && confirm(`√ätes-vous s√ªr de vouloir supprimer le produit "${product.name?.fr || product.name || 'ce produit'}" ?`)) {
        try {
            await firebase.firestore().collection('products').doc(productId).delete();
            console.log('‚úÖ Produit supprim√©');
            alert('Produit supprim√© avec succ√®s');
            
            // Recharger les produits
            loadProducts();
            
        } catch (error) {
            console.error('‚ùå Erreur lors de la suppression:', error);
            alert('Erreur lors de la suppression: ' + error.message);
        }
    }
};e,
        price: salePrice, // Prix de vente pour compatibilit√© avec le site principal
        salePrice: salePrice,
        stock: stock,
        category: category,
        description: {
            ar: descriptionAr,
            fr: descriptionFr
        },
        image: image || '', // Image en base64 ou URL
        createdAt: firebase.firestore.FieldValue.serverTimestamp(),
        updatedAt: firebase.firestore.FieldValue.serverTimestamp()
    };
    
    console.log('üì¶ Donn√©es du produit:', productData);
    
    try {
        const docRef = await firebase.firestore().collection('products').add(productData);
        console.log('‚úÖ Produit sauvegard√© avec ID:', docRef.id);
        
        alert('Produit ajout√© avec succ√®s !');
        closeProductModal();
        
        // Recharger les produits
        loadProducts();
        
    } catch (error) {
        console.error('‚ùå Erreur lors de la sauvegarde:', error);
        alert('Erreur lors de la sauvegarde: ' + error.message);
    }
};

// Fonction pour charger tous les produits
async function loadProducts() {
    console.log('üì¶ Chargement des produits...');
    
    try {
        const productsSnapshot = await firebase.firestore()
            .collection('products')
            .orderBy('createdAt', 'desc')
            .get();

        products = [];
        productsSnapshot.forEach(doc => {
            products.push({ id: doc.id, ...doc.data() });
        });

        console.log('üìä Nombre total de produits:', products.length);
        displayProducts();

    } catch (error) {
        console.error('‚ùå Erreur lors du chargement des produits:', error);
        showError('Erreur lors du chargement des produits: ' + error.message);
    }
}

// Fonction pour afficher les produits
function displayProducts() {
    console.log('üìã Affichage des produits...');
    const tbody = document.getElementById('productsTableBody');
    if (!tbody) {
        console.error('‚ùå √âl√©ment productsTableBody non trouv√©');
        return;
    }

    tbody.innerHTML = '';

    if (products.length === 0) {
        tbody.innerHTML = '<tr><td colspan="9" style="text-align: center;">Aucun produit trouv√©</td></tr>';
        console.log('‚ÑπÔ∏è Aucun produit √† afficher');
        return;
    }

    console.log('üìù Affichage de', products.length, 'produits');
    products.forEach((product, index) => {
        console.log(`üì¶ Produit ${index + 1}:`, product);
        const row = createProductRow(product);
        tbody.appendChild(row);
    });
}

// Fonction pour cr√©er une ligne de produit
function createProductRow(product) {
    const tr = document.createElement('tr');
    
    const nameAr = product.name?.ar || product.name || 'N/A';
    const nameFr = product.name?.fr || product.name || 'N/A';
    const purchasePrice = product.purchasePrice || 0;
    const salePrice = product.price || product.salePrice || 0;
    const stock = product.stock || 0;
    const category = product.category || 'N/A';
    
    // Calculer la marge
    const margin = purchasePrice > 0 ? ((salePrice - purchasePrice) / purchasePrice * 100).toFixed(1) : 0;
    const marginClass = margin > 30 ? 'high-margin' : margin > 15 ? 'medium-margin' : 'low-margin';
    
    // Image du produit
    const imageUrl = product.image || '../image/default-product.jpg';

    tr.innerHTML = `
        <td>
            <img src="${imageUrl}" alt="${nameFr}" class="product-image" onerror="this.src='../image/default-product.jpg'">
        </td>
        <td><strong>${nameAr}</strong></td>
        <td><strong>${nameFr}</strong></td>
        <td class="purchase-price">${purchasePrice.toLocaleString()} DA</td>
        <td class="sale-price">${salePrice.toLocaleString()} DA</td>
        <td class="margin ${marginClass}">
            <span class="margin-value">${margin}%</span>
            <small class="margin-amount">+${(salePrice - purchasePrice).toLocaleString()} DA</small>
        </td>
        <td class="stock-info">
            <span class="stock-count ${stock < 10 ? 'low-stock' : stock < 5 ? 'critical-stock' : ''}">${stock}</span>
            <small>unit√©s</small>
        </td>
        <td><span class="category-badge">${getCategoryText(category)}</span></td>
        <td>
            <div class="action-buttons">
                <button class="btn btn-sm btn-info" onclick="viewProduct('${product.id}')" title="Voir d√©tails">
                    <i class="fas fa-eye"></i>
                </button>
                <button class="btn btn-sm btn-warning" onclick="editProduct('${product.id}')" title="Modifier">
                    <i class="fas fa-edit"></i>
                </button>
                <button class="btn btn-sm btn-success" onclick="updateStock('${product.id}')" title="G√©rer stock">
                    <i class="fas fa-boxes"></i>
                </button>
                <button class="btn btn-sm btn-danger" onclick="deleteProduct('${product.id}')" title="Supprimer">
                    <i class="fas fa-trash"></i>
                </button>
            </div>
        </td>
    `;
    
    return tr;
}

// Fonction pour obtenir le texte de la cat√©gorie
function getCategoryText(category) {
    const categories = {
        hair: 'Cheveux',
        makeup: 'Maquillage',
        skincare: 'Soins',
        lenses: 'Lentilles',
        clothing: 'V√™tements'
    };
    return categories[category] || category;
}

// Fonction pour voir un produit
window.viewProduct = function(productId) {
    console.log('üëÅÔ∏è Voir produit:', productId);
    const product = products.find(p => p.id === productId);
    if (product) {
        console.log('üì¶ D√©tails du produit:', product);
        alert(`Produit: ${product.name?.fr || product.name || 'N/A'}\nPrix d'achat: ${product.purchasePrice || 0} DA\nPrix de vente: ${product.price || 0} DA\nStock: ${product.stock || 0} unit√©s`);
    }
};

// Fonction pour modifier un produit
window.editProduct = function(productId) {
    console.log('‚úèÔ∏è Modifier produit:', productId);
    const product = products.find(p => p.id === productId);
    if (product) {
        showAddProductModal();
        
        // Remplir le formulaire avec les donn√©es du produit
        const title = document.getElementById('productModalTitle');
        if (title) title.textContent = 'Modifier le produit';
        
        // Remplir tous les champs
        const nameAr = document.getElementById('productNameAr');
        const nameFr = document.getElementById('productNameFr');
        const purchasePrice = document.getElementById('productPurchasePrice');
        const salePrice = document.getElementById('productPrice');
        const stock = document.getElementById('productStock');
        const category = document.getElementById('productCategory');
        const descriptionAr = document.getElementById('productDescriptionAr');
        const descriptionFr = document.getElementById('productDescriptionFr');
        
        if (nameAr) nameAr.value = product.name?.ar || product.name || '';
        if (nameFr) nameFr.value = product.name?.fr || product.name || '';
        if (purchasePrice) purchasePrice.value = product.purchasePrice || 0;
        if (salePrice) salePrice.value = product.price || product.salePrice || 0;
        if (stock) stock.value = product.stock || 0;
        if (category) category.value = product.category || '';
        if (descriptionAr) descriptionAr.value = product.description?.ar || '';
        if (descriptionFr) descriptionFr.value = product.description?.fr || '';
        
        // Afficher l'image si elle existe
        if (product.image) {
            const imagePreview = document.getElementById('imagePreview');
            const imageInput = document.getElementById('productImage');
            if (imagePreview && imageInput) {
                imagePreview.innerHTML = `
                    <img src="${product.image}" alt="Image actuelle" style="max-width: 200px; max-height: 200px; border-radius: 8px;">
                    <p>Image actuelle</p>
                `;
                imageInput.value = product.image;
            }
        }
        
        // Stocker l'ID du produit pour la mise √† jour
        const form = document.getElementById('productForm');
        if (form) {
            form.setAttribute('data-product-id', productId);
        }
        
        // Calculer la rentabilit√©
        calculateProfit();
        
        console.log('‚úÖ Formulaire rempli pour modification');
    }
};

// Fonction pour mettre √† jour le stock
window.updateStock = async function(productId) {
    console.log('üì¶ G√©rer stock:', productId);
    const product = products.find(p => p.id === productId);
    if (product) {
        const currentStock = product.stock || 0;
        const newStock = prompt(`Stock actuel: ${currentStock} unit√©s\nNouveau stock pour "${product.name?.fr || product.name || 'ce produit'}":`, currentStock);
        
        if (newStock !== null && !isNaN(newStock) && parseInt(newStock) >= 0) {
            try {
                await firebase.firestore().collection('products').doc(productId).update({
                    stock: parseInt(newStock),
                    updatedAt: firebase.firestore.FieldValue.serverTimestamp()
                });
                
                console.log('‚úÖ Stock mis √† jour:', newStock);
                alert(`Stock mis √† jour: ${newStock} unit√©s`);
                
                // Recharger les produits pour afficher la mise √† jour
                loadProducts();
                
            } catch (error) {
                console.error('‚ùå Erreur lors de la mise √† jour du stock:', error);
                alert('Erreur lors de la mise √† jour du stock: ' + error.message);
            }
        }
    }
};

// Fonction pour supprimer un produit
window.deleteProduct = async function(productId) {
    console.log('üóëÔ∏è Supprimer produit:', productId);
    const product = products.find(p => p.id === productId);
    
    if (product && confirm(`√ätes-vous s√ªr de vouloir supprimer le produit "${product.name?.fr || product.name || 'ce produit'}" ?`)) {
        try {
            await firebase.firestore().collection('products').doc(productId).delete();
            console.log('‚úÖ Produit supprim√©');
            alert('Produit supprim√© avec succ√®s');
            
            // Recharger les produits
            loadProducts();
            
        } catch (error) {
            console.error('‚ùå Erreur lors de la suppression:', error);
            alert('Erreur lors de la suppression: ' + error.message);
        }
    }
};

// Fonctions expos√©es globalement
window.viewOrder = function(orderId) {
    console.log('üëÅÔ∏è Voir commande:', orderId);
    const order = orders.find(o => o.id === orderId);
    if (order) {
        console.log('üìÑ D√©tails de la commande:', order);
        alert('Commande: ' + (order.customerName || 'N/A') + ' - ' + (order.total || '0') + ' DA');
    }
};

window.editOrderStatus = function(orderId) {
    console.log('‚úèÔ∏è Modifier statut commande:', orderId);
    alert('Fonctionnalit√© de modification du statut en d√©veloppement');
};

window.deleteOrder = function(orderId) {
    console.log('üóëÔ∏è Supprimer commande:', orderId);
    if (confirm('√ätes-vous s√ªr de vouloir supprimer cette commande ?')) {
        alert('Fonctionnalit√© de suppression en d√©veloppement');
    }
};

// Navigation basique
function handleNavigation(e) {
    e.preventDefault();
    console.log('üß≠ Navigation cliqu√©e');
    
    const sectionName = e.target.getAttribute('data-section');
    console.log('üìç Section:', sectionName);
    
    if (!sectionName) return;

    // Mettre √† jour le menu actif
    document.querySelectorAll('.menu-item').forEach(item => {
        item.classList.remove('active');
    });
    e.target.classList.add('active');

    // Afficher la section correspondante
    document.querySelectorAll('.content-section').forEach(section => {
        section.classList.remove('active');
    });
    
    const sectionElement = document.getElementById(sectionName + 'Section');
    if (sectionElement) {
        sectionElement.classList.add('active');
        console.log('‚úÖ Section affich√©e:', sectionName);
    } else {
        console.error('‚ùå Section non trouv√©e:', sectionName + 'Section');
    }

    // Mettre √† jour le titre de la page
    const titles = {
        dashboard: 'Dashboard',
        products: 'Gestion des Produits',
        orders: 'Gestion des Commandes',
        account: 'Mon Compte',
        analytics: 'Statistiques',
        settings: 'Param√®tres'
    };
    
    const pageTitleElement = document.getElementById('pageTitle');
    if (pageTitleElement) {
        pageTitleElement.textContent = titles[sectionName] || sectionName;
        console.log('‚úÖ Titre mis √† jour:', titles[sectionName] || sectionName);
    }

    // Charger les donn√©es de la section
    loadSectionData(sectionName);
}

// Fonction pour charger les donn√©es selon la section
function loadSectionData(sectionName) {
    console.log('üìÇ Chargement des donn√©es pour la section:', sectionName);
    
    switch(sectionName) {
        case 'dashboard':
            loadDashboardData();
            break;
        case 'orders':
            loadOrders();
            break;
        case 'products':
            console.log('üì¶ Section produits - fonctionnalit√© √† impl√©menter');
            break;
        case 'analytics':
            console.log('üìä Section analytics - fonctionnalit√© √† impl√©menter');
            break;
        case 'account':
            console.log('üë§ Section compte - fonctionnalit√© √† impl√©menter');
            break;
        case 'settings':
            console.log('‚öôÔ∏è Section param√®tres - fonctionnalit√© √† impl√©menter');
            break;
        default:
            console.log('‚ùì Section inconnue:', sectionName);
    }
}

// Fonctions d'affichage des messages
function showError(message) {
    console.error('‚ùå', message);
    alert('Erreur: ' + message);
}

function showSuccess(message) {
    console.log('‚úÖ', message);
    alert('Succ√®s: ' + message);
}

function showLoading(message) {
    console.log('‚è≥', message);
    // Impl√©mentation basique du loading
}

function hideLoading() {
    console.log('‚úÖ Loading termin√©');
    // Impl√©mentation basique du loading
}

console.log('‚úÖ Admin panel debug initialis√©');